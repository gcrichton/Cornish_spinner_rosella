<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>Mutations on an Arc</title>

	<!-- D3.js -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
	
	<!-- mut names -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&display=swap" rel="stylesheet">
	
	<style>
		#chart{
			text-align: left;
			margin-left: -10;
		}
		
		*[class^='mutArc']{ 
			/*fill: white;*/
			/*stroke: #AAAAAA;*/
			
		}
		
		
		/*.mutText, .mutText2{*/
			*[class^='mutText']{
			/*fill: #6B6B6B;*/
			font-size: 13px;
			font-family: 'Zen Kurenaido', sans-serif;
			font-weight: bold;
			
		}
		
		.mutArc {
			/*fill:black;*/
		}
		
		.mutText1 {
			color: white;
			fill: white;
			font-weight: bold;
		}
			
		.clickedM {
			color:red;
			fill:blue;
		}
		}
	</style>
  </head>
  <body>

	<div id="chart"></div>
	
    <script>
		
		//variables
		const letters = ["Unmutated", "Soft", "Breathed", "Hard", "Mixed", "Mixed after 'th'"];
const mutation = ["B", "Ch", "D", "G (a, e, i, y)", "G (l, r)", "Gw", "G (o, u, ro, ru)", "K", "M", "P", "T"];  
const mutations = [
['B','V',' ','P','F','V'],
['Ch','J','','','',''],
['D','Dh','','T','T','T'],
['Ga','-','','K','H','H'],
['Gl','-','','K','',''],
['Gw','W','','Kw','Hw','W'],
['Go','W','','K','Hw','W'],
['K','G','H','','',''],
['M','V','','','F','V'],
['P','B','F','','',''],
['T','D','Th','','',''],
["Unmutated", "Soft", "Breathed", "Hard", "Mixed", "Af. 'th'"]

]; //two dimensional array


		
		// Set up

		var screenWidth = window.innerWidth;

		var margin = {left: 20, top: 20, right: 20, bottom: 20},
			width = Math.min(screenWidth, 500) - margin.left - margin.right,
			height = Math.min(screenWidth, 500) - margin.top - margin.bottom;
					
		var svg = d3.select("#chart").append("svg")
					.attr("width", (width + margin.left + margin.right))
					.attr("height", (height + margin.top + margin.bottom))
				  .append("g").attr("class", "wrapper")
					.attr("transform", "translate(" + (width / 2 + margin.left) + "," + (height / 2 + margin.top) + ")");

		

		//The start date number and end date number of the muts in a year
		var mData = [
			{mut: "Unmutated", 	startDeg: 0, 	endDeg: 30},
			{mut: "Soft", startDeg: 31, 	endDeg: 58},
			{mut: "Breathed", 	startDeg: 59, 	endDeg: 89},
			{mut: "Hard", 	startDeg: 90, 	endDeg: 119},
			{mut: "Mixed", 		startDeg: 120, 	endDeg: 150},
			{mut: "Mixed (after 'th')", 	startDeg: 151, 	endDeg: 180},
			{mut: "", 	startDeg: 181, 	endDeg: 211},
			{mut: "", 	startDeg: 212, 	endDeg: 242},
			{mut: "",startDeg: 243, 	endDeg: 272},
			{mut: "", 	startDeg: 273, 	endDeg: 303},
			{mut: "", startDeg: 306, 	endDeg: 333},
			{mut: "",	startDeg: 334, 	endDeg: 364}
		];

		//Creates a function that makes SVG paths in the shape of arcs with the specified inner and outer radius 
		var arc1 = d3.svg.arc()
			.innerRadius(width*0.9/2) 
			.outerRadius(width*0.9/2 + 30);
		  
		  
		  var arc2 = d3.svg.arc()
			.innerRadius(width*0.76/2) 
			.outerRadius(width*0.76/2 + 30);
			
			 var arc3 = d3.svg.arc()
			.innerRadius(width*0.62/2) 
			.outerRadius(width*0.62/2 + 30)
			//.startAngle(0)
			//.endAngle(6.28)
			;
			
			var arc4 = d3.svg.arc()
			.innerRadius(width*0.48/2) 
			.outerRadius(width*0.48/2 + 30);
		  
		  var arc5 = d3.svg.arc()
			.innerRadius(width*0.34/2) 
			.outerRadius(width*0.34/2 + 30);
			var arc6 = d3.svg.arc()
			.innerRadius(width*0.20/2) 
			.outerRadius(width*0.20/2 + 30);
		  
		//Creates function that will turn the mut data into start and end angles
		var pie = d3.layout.pie()
			.value(function(d) { return d.endDeg - d.startDeg; })
			.padAngle(.01)
			.sort(null);


function setClicked(m){ //mutArc1_0 mutArc2_0 mutArc3_0 etc

	
	//clear current
	elements=document.getElementsByClassName('clickedM');

for(element of elements){
	console.log(element.id);
  element.classList.remove('clickedM');
  
}

	for(i=1;i<7;i++){
		var ss = m.substr(7);
		
		document.getElementById(m).classList.add('clickedM');
		document.getElementById('mutArc' + i + ss).classList.add('clickedM');
		
	}
}

		
		// Create the parts

		//Draw the arcs themselves
		svg.selectAll(".mutArc1")
			.data(pie(mData))
		   .enter().append("path")
			.attr("class", "mutArc1")
			.attr("id", function(d,i) { console.log('d ' +d + ', i ' + i);return "mutArc1_"+i; })
			.attr("fill", function(d,i) { return (i < 11 ? '#404040' : 'white'); })
			.attr("stroke", function(d,i) { return (i < 11 ? '#AAAAAA' : '#D3D3D3'); }) //FIX add this to next arc ad style appropriately
			.attr("d", arc1)
			.attr("onclick",'setClicked(this.id)');
			
			
			svg.selectAll(".mutArc2")
			.data(pie(mData))
		   .enter().append("path")
			.attr("class", "mutArc2")
			.attr("id", function(d,i) { console.log('d2 ' +d + ', i ' + i);return "mutArc2_"+i; })
			.attr("fill", function(d,i) { return (i < 11 ? '#AAAAAA' : 'white'); })
			.attr("stroke", function(d,i) { return (i < 11 ? '#AAAAAA' : '#D3D3D3'); })
			.attr("d", arc2);
			
			svg.selectAll(".mutArc3")
			.data(pie(mData))
		   .enter().append("path")
			.attr("class", "mutArc3")
			.attr("id", function(d,i) { return "mutArc3_"+i; })
			.attr("fill", function(d,i) { return (i < 11 ? '#AAAAAA' : 'white'); })
			.attr("stroke", function(d,i) { return (i < 11 ? '#AAAAAA' : '#D3D3D3'); })
			.attr("d", arc3);
			
			svg.selectAll(".mutArc4")
			.data(pie(mData))
		   .enter().append("path")
			.attr("class", "mutArc4")
			.attr("id", function(d,i) { return "mutArc4_"+i; })
			.attr("fill", function(d,i) { return (i < 11 ? '#AAAAAA' : 'white'); })
			.attr("stroke", function(d,i) { return (i < 11 ? '#AAAAAA' : '#D3D3D3'); })
			.attr("d", arc4);
			
			svg.selectAll(".mutArc5")
			.data(pie(mData))
		   .enter().append("path")
			.attr("class", "mutArc5")
			.attr("id", function(d,i) { return "mutArc5_"+i; })
			.attr("fill", function(d,i) { return (i < 11 ? '#AAAAAA' : 'white'); })
			.attr("stroke", function(d,i) { return (i < 11 ? '#AAAAAA' : '#D3D3D3'); })
			.attr("d", arc5);
			
			svg.selectAll(".mutArc6")
			.data(pie(mData))
		   .enter().append("path")
			.attr("class", "mutArc6")
			.attr("id", function(d,i) { return "mutArc6_"+i; })
			.attr("fill", function(d,i) { return (i < 11 ? '#AAAAAA' : 'white'); })
			.attr("stroke", function(d,i) { return (i < 11 ? '#AAAAAA' : '#D3D3D3'); })
			.attr("d", arc6);
			
		//Append the mut names within the arcs
		svg.selectAll(".mutText1")
			.data(mData)
		   .enter().append("text")
			.attr("class", "mutText1")
			.attr("x", 5) //Move the text from the start angle of the arc
			.attr("dy", 18) //Move the text down
		   .append("textPath")
			.attr("xlink:href",function(d,i){return "#mutArc1_"+i;})
			.text(function(d,i){return mutation[i];});	
			
			svg.selectAll(".mutText2")
			.data(mData) //FIX change this to mutation array
		   .enter().append("text")
			.attr("class", "mutText2")
			.attr("x", 5) //Move the text from the start angle of the arc
			.attr("dy", 18) //Move the text down
		   .append("textPath")
			.attr("xlink:href",function(d,i){return "#mutArc2_"+i;})
			.text(function(d,i){return mutations[i][1];});	
			
			svg.selectAll(".mutText3")
			.data(mData)
		   .enter().append("text")
			.attr("class", "mutText3")
			.attr("x", 5) //Move the text from the start angle of the arc
			.attr("dy", 18) //Move the text down
		   .append("textPath")
			.attr("xlink:href",function(d,i){return "#mutArc3_"+i;})
			.text(function(d,i){return mutations[i][2];});		
			
			svg.selectAll(".mutText4")
			.data(mData)
		   .enter().append("text")
			.attr("class", "mutText4")
			.attr("x", 5) //Move the text from the start angle of the arc
			.attr("dy", 18) //Move the text down
		   .append("textPath")
			.attr("xlink:href",function(d,i){return "#mutArc4_"+i;})
			.text(function(d,i){return mutations[i][3];});	
			
			svg.selectAll(".mutText5")
			.data(mData)
		   .enter().append("text")
			.attr("class", "mutText5")
			.attr("x", 5) //Move the text from the start angle of the arc
			.attr("dy", 18) //Move the text down
		   .append("textPath")
			.attr("xlink:href",function(d,i){return "#mutArc5_"+i;})
			.text(function(d,i){return mutations[i][4];});	
			
			svg.selectAll(".mutText6")
			.data(mData)
		   .enter().append("text")
			.attr("class", "mutText6")
			.attr("x", 5) //Move the text from the start angle of the arc
			.attr("dy", 18) //Move the text down
		   .append("textPath")
			.attr("xlink:href",function(d,i){return "#mutArc6_"+i;})
			.text(function(d,i){return mutations[i][5];});	
	</script>
	
  </body>
</html>
